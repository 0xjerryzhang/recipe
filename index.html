<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶…ç´šå¤§æ¨‚é€ - æ™ºèƒ½æ•¸æ“šé¸è™ŸåŠ©æ‰‹</title>
    <meta name="description" content="åŸºæ–¼è¿‘100æœŸé–‹çæ•¸æ“šåˆ†æçš„è¶…ç´šå¤§æ¨‚é€é¸è™Ÿå·¥å…·">
    
    <!-- å¼•å…¥å¤–éƒ¨åº« (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Roboto+Mono:wght@500&display=swap');

        :root {
            --primary-red: #ef4444;
            --primary-blue: #3b82f6;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f2f5;
            /* èƒŒæ™¯åœ–æ¡ˆ */
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* çƒé«”æ¨£å¼ */
        .ball {
            width: 2.75rem;
            height: 2.75rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-family: 'Roboto Mono', monospace;
            font-size: 1.15rem;
            box-shadow: inset -2px -2px 6px rgba(0,0,0,0.2), 2px 2px 4px rgba(0,0,0,0.1);
            position: relative;
            user-select: none;
            transition: transform 0.2s;
        }

        .ball:hover {
            transform: scale(1.1);
        }

        .ball::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 15%;
            width: 30%;
            height: 30%;
            background: radial-gradient(circle, rgba(255,255,255,0.9), rgba(255,255,255,0));
            border-radius: 50%;
        }

        .ball-red {
            background: linear-gradient(145deg, #ff6b6b, #c92a2a);
            color: white;
            border: 1px solid #b92b27;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.2);
        }

        .ball-blue {
            background: linear-gradient(145deg, #4dabf7, #1864ab);
            color: white;
            border: 1px solid #1864ab;
            text-shadow: 1px 1px 0px rgba(0,0,0,0.2);
        }

        /* ç»ç’ƒæ“¬æ…‹é¢æ¿ */
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* å‹•ç•« */
        @keyframes rollIn {
            0% { transform: translateY(-20px) rotate(-180deg); opacity: 0; }
            100% { transform: translateY(0) rotate(0); opacity: 1; }
        }
        .animate-roll { animation: rollIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }

        /* è‡ªå®šç¾©æ»¾å‹•æ¢ */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="min-h-screen py-6 px-3 lg:px-8 text-gray-800">

    <div class="max-w-5xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <!-- é ‚éƒ¨æ¨™é¡Œ (Mobile & Desktop) -->
        <div class="lg:col-span-12 flex justify-between items-end mb-2">
            <div>
                <h1 class="text-3xl font-black text-gray-800 tracking-tight flex items-center gap-3">
                    <span class="bg-gradient-to-r from-red-600 to-orange-500 text-transparent bg-clip-text">è¶…ç´šå¤§æ¨‚é€</span>
                    <span class="text-xs bg-gray-800 text-white px-2 py-1 rounded-md font-normal tracking-wide">PROç‰ˆ</span>
                </h1>
                <p class="text-sm text-gray-500 mt-1 font-medium">åŸºæ–¼æ­·å²å¤§æ•¸æ“šæ¬Šé‡é‹ç®—æ¨¡å‹</p>
            </div>
            <a href="https://github.com" target="_blank" class="text-gray-400 hover:text-gray-800 transition-colors">
                <i class="fab fa-github text-2xl"></i>
            </a>
        </div>

        <!-- å·¦å´ï¼šæ ¸å¿ƒç”Ÿæˆå™¨ (ä½” 7 æ ¼) -->
        <div class="lg:col-span-7 space-y-6">
            
            <!-- ä¸»æ§åˆ¶å° -->
            <div class="glass-panel rounded-2xl p-6 border-t-4 border-red-500 relative overflow-hidden">
                <!-- è£é£¾èƒŒæ™¯åœ–æ¨™ -->
                <div class="absolute -top-6 -right-6 text-gray-100 transform rotate-12 pointer-events-none">
                    <i class="fas fa-ticket-alt text-9xl opacity-50"></i>
                </div>

                <!-- ç®—æ³•é¸æ“‡ -->
                <div class="flex justify-between items-center mb-6 relative z-10">
                    <div class="flex items-center gap-2 bg-white/60 px-3 py-1.5 rounded-lg border border-gray-200">
                        <i class="fas fa-microchip text-blue-500"></i>
                        <span class="text-xs font-bold text-gray-600">é‹ç®—æ ¸å¿ƒï¼š</span>
                        <select id="algo-select" class="text-sm bg-transparent font-bold text-gray-800 outline-none cursor-pointer">
                            <option value="weighted">å†·ç†±åŠ æ¬Š (æ¨è–¦)</option>
                            <option value="random">å®Œå…¨éš¨æ©Ÿ</option>
                            <option value="contrarian">é€†å‘æ€ç¶­ (è¿½å†·)</option>
                        </select>
                    </div>
                    <div id="clock" class="text-xs font-mono text-gray-400 hidden sm:block">00:00:00</div>
                </div>

                <!-- è™Ÿç¢¼é¡¯ç¤ºå€ -->
                <div id="balls-area" class="min-h-[100px] flex flex-wrap justify-center items-center gap-3 mb-8 bg-gradient-to-b from-white to-gray-50 rounded-xl p-6 border border-gray-200 shadow-inner">
                    <div class="text-center">
                        <i class="fas fa-fingerprint text-4xl text-gray-200 mb-2"></i>
                        <p class="text-gray-400 text-sm">é»æ“ŠæŒ‰éˆ•å•Ÿå‹•æ™ºèƒ½é‹ç®—</p>
                    </div>
                </div>

                <!-- æŒ‰éˆ•å€ -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 relative z-10">
                    <button onclick="generateLottery(1)" class="group bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 text-white font-bold py-4 px-6 rounded-xl shadow-lg shadow-red-200 transform active:scale-[0.98] transition-all flex items-center justify-center gap-2">
                        <i class="fas fa-magic group-hover:rotate-12 transition-transform"></i> 
                        ç”Ÿæˆä¸€æ³¨å¹¸é‹è™Ÿ
                    </button>
                    <div class="flex gap-2">
                        <button onclick="generateLottery(5)" class="flex-1 bg-white border-2 border-gray-100 text-gray-700 font-bold py-3 px-4 rounded-xl hover:bg-gray-50 hover:border-red-100 transition-all active:scale-95">
                            5 æ³¨é€£ç™¼
                        </button>
                        <button onclick="copyResults()" title="è¤‡è£½çµæœ" class="flex-none w-16 bg-white border-2 border-gray-100 text-gray-600 font-bold py-3 px-4 rounded-xl hover:bg-blue-50 hover:text-blue-600 hover:border-blue-100 transition-all active:scale-95 flex items-center justify-center">
                            <i class="far fa-copy text-lg"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- æ­·å²è¨˜éŒ„ -->
            <div class="glass-panel rounded-2xl p-5">
                <div class="flex justify-between items-center mb-4 border-b border-gray-100 pb-2">
                    <h3 class="font-bold text-gray-700 text-sm flex items-center gap-2">
                        <i class="fas fa-history text-gray-400"></i> ç”Ÿæˆè¨˜éŒ„
                    </h3>
                    <button onclick="clearHistory()" class="text-xs text-red-400 hover:text-red-600 transition-colors px-2 py-1 rounded hover:bg-red-50">
                        æ¸…ç©º
                    </button>
                </div>
                <div id="history-container" class="space-y-2 max-h-[250px] overflow-y-auto pr-2 custom-scrollbar">
                    <div class="text-center text-xs text-gray-400 py-10">å°šç„¡æ•¸æ“š</div>
                </div>
            </div>
        </div>

        <!-- å³å´ï¼šæ•¸æ“šåˆ†æå„€è¡¨æ¿ (ä½” 5 æ ¼) -->
        <div class="lg:col-span-5 space-y-6">
            
            <!-- å¤§æ•¸æ“šåˆ†æå¡ -->
            <div class="glass-panel rounded-2xl p-6 border-t-4 border-blue-500 h-full flex flex-col">
                <div class="mb-6">
                    <h3 class="font-bold text-gray-800 text-lg flex items-center gap-2">
                        <i class="fas fa-chart-pie text-blue-500"></i> 100æœŸæ•¸æ“šæ´å¯Ÿ
                    </h3>
                    <p class="text-xs text-gray-500">æ•¸æ“šä¾†æºï¼šæ­·å²é–‹çè™Ÿç¢¼é »ç‡çµ±è¨ˆ</p>
                </div>
                
                <!-- å‰å€ç†±è™Ÿ -->
                <div class="mb-6 bg-white/50 p-4 rounded-xl border border-gray-100">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-gray-600">ğŸ”¥ å‰å€ç†±é–€ Top 5</span>
                    </div>
                    <div id="front-hot-stats" class="grid grid-cols-5 gap-2">
                        <!-- JS å¡«å…… -->
                    </div>
                </div>

                <!-- å¾Œå€ç†±è™Ÿ -->
                <div class="mb-6 bg-white/50 p-4 rounded-xl border border-gray-100">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm font-bold text-gray-600">ğŸ’ å¾Œå€ç†±é–€ Top 3</span>
                    </div>
                    <div id="back-hot-stats" class="grid grid-cols-3 gap-2">
                        <!-- JS å¡«å…… -->
                    </div>
                </div>

                <!-- èµ°å‹¢åœ– -->
                <div class="flex-1 min-h-[150px]">
                    <p class="text-xs font-bold text-gray-400 mb-2">å¥‡å¶åˆ†ä½ˆè¶¨å‹¢æ¨¡æ“¬</p>
                    <div class="relative h-full w-full">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨ç‰ˆæ¬Š -->
    <div class="text-center text-gray-400 text-xs py-8">
        <p>æœ¬å·¥å…·åƒ…ä¾›å¨›æ¨‚èˆ‡çµ±è¨ˆåƒè€ƒï¼Œä¸ä¿è­‰ä¸­çã€‚</p>
        <p class="mt-1">è«‹ç†æ€§è³¼å½©ï¼Œé‡åŠ›è€Œè¡Œã€‚</p>
    </div>

    <!-- æç¤ºæ¡† Toast -->
    <div id="toast" class="fixed top-6 left-1/2 transform -translate-x-1/2 bg-gray-800/90 text-white px-6 py-3 rounded-full shadow-2xl opacity-0 transition-all duration-300 pointer-events-none z-50 flex items-center gap-3 backdrop-blur-sm">
        <div class="bg-green-500 rounded-full p-1"><i class="fas fa-check text-xs"></i></div>
        <span id="toast-msg" class="text-sm font-medium">æ“ä½œæˆåŠŸ</span>
    </div>

    <script>
        /**
         * æ•¸æ“šé…ç½®å€
         * æ³¨æ„ï¼šçœŸå¯¦æ‡‰ç”¨ä¸­ï¼Œé€™è£¡æ‡‰è©²å¾å¾Œç«¯ API ç²å–
         * é€™è£¡ä½¿ç”¨åŸºæ–¼è¿‘æœŸè¶¨å‹¢çš„æ¨¡æ“¬æ•¸æ“š
         */
        const DATA_SOURCE = {
            front: {
                hot: [13, 22, 30, 07, 28, 04, 35, 19], // ç†±é–€
                cold: [03, 11, 24, 08, 15]             // å†·é–€
            },
            back: {
                hot: [03, 07, 10, 01],
                cold: [05, 12, 06]
            },
            weights: { front: {}, back: {} }
        };

        // åˆå§‹åŒ–æ¬Šé‡ç³»çµ±
        function initWeights() {
            // å‰å€åˆå§‹åŒ–ï¼šé»˜èªæ¬Šé‡ 10
            for(let i=1; i<=35; i++) DATA_SOURCE.weights.front[i] = 10;
            // æ ¹æ“šç†±é–€åº¦èª¿æ•´
            DATA_SOURCE.front.hot.forEach(n => DATA_SOURCE.weights.front[n] = 35); // ç†±è™ŸåŠ æ¬Š
            DATA_SOURCE.front.cold.forEach(n => DATA_SOURCE.weights.front[n] = 4); // å†·è™Ÿé™æ¬Š

            // å¾Œå€åˆå§‹åŒ–ï¼šé»˜èªæ¬Šé‡ 10
            for(let i=1; i<=12; i++) DATA_SOURCE.weights.back[i] = 10;
            DATA_SOURCE.back.hot.forEach(n => DATA_SOURCE.weights.back[n] = 30);
            DATA_SOURCE.back.cold.forEach(n => DATA_SOURCE.weights.back[n] = 5);
        }

        // åŠ æ¬Šéš¨æ©Ÿç®—æ³•
        function getWeightedRandom(pool, weightsObj, strategy) {
            let totalWeight = 0;
            const tempPool = pool.map(num => {
                let w = weightsObj[num] || 10;
                
                // ç­–ç•¥èª¿æ•´
                if (strategy === 'random') w = 10; // ç´”éš¨æ©Ÿ
                if (strategy === 'contrarian') w = (40 - w); // åå‘è¿½å†· (åŸæœ¬æ¬Šé‡è¶Šå°ç¾åœ¨è¶Šå¤§)
                
                totalWeight += w;
                return { num, weight: w };
            });

            const randomVal = Math.random() * totalWeight;
            let currentTotal = 0;

            for (let item of tempPool) {
                currentTotal += item.weight;
                if (randomVal <= currentTotal) return item.num;
            }
            return tempPool[tempPool.length - 1].num; // Fallback
        }

        function generateSet(strategy) {
            // å‰å€ 5 å€‹
            const frontSet = new Set();
            const frontPool = Array.from({length: 35}, (_, i) => i + 1);
            
            let attempts = 0;
            while(frontSet.size < 5 && attempts < 1000) {
                const num = getWeightedRandom(frontPool, DATA_SOURCE.weights.front, strategy);
                frontSet.add(num);
                attempts++;
            }

            // å¾Œå€ 2 å€‹
            const backSet = new Set();
            const backPool = Array.from({length: 12}, (_, i) => i + 1);
            
            attempts = 0;
            while(backSet.size < 2 && attempts < 1000) {
                const num = getWeightedRandom(backPool, DATA_SOURCE.weights.back, strategy);
                backSet.add(num);
                attempts++;
            }

            return {
                front: Array.from(frontSet).sort((a,b)=>a-b),
                back: Array.from(backSet).sort((a,b)=>a-b)
            };
        }

        // UI æ¸²æŸ“
        const zeroPad = (n) => n.toString().padStart(2, '0');
        let currentHistory = [];

        function renderBall(num, type, index) {
            const colorClass = type === 'front' ? 'ball-red' : 'ball-blue';
            return `<div class="ball ${colorClass} animate-roll" style="animation-delay: ${index * 50}ms">
                        ${zeroPad(num)}
                    </div>`;
        }

        async function generateLottery(count) {
            const ballsArea = document.getElementById('balls-area');
            const historyContainer = document.getElementById('history-container');
            const strategy = document.getElementById('algo-select').value;

            // Loading
            ballsArea.innerHTML = `
                <div class="flex flex-col items-center justify-center py-4">
                    <div class="w-10 h-10 border-4 border-red-200 border-t-red-600 rounded-full animate-spin mb-2"></div>
                    <span class="text-xs text-red-500 font-bold tracking-widest">AIé‹ç®—ä¸­...</span>
                </div>
            `;

            // æ¨¡æ“¬é‹ç®—æ™‚é–“ (ç‚ºäº†è¦–è¦ºæ•ˆæœ)
            await new Promise(r => setTimeout(r, 400));

            const newSets = [];
            for(let i=0; i<count; i++) newSets.push(generateSet(strategy));

            // æ›´æ–°ä¸»é¡¯ç¤ºå€ (é¡¯ç¤ºç¬¬ä¸€æ³¨)
            const mainSet = newSets[0];
            let html = '';
            mainSet.front.forEach((n, i) => html += renderBall(n, 'front', i));
            html += `<div class="w-px h-10 bg-gray-300 mx-3 hidden sm:block"></div>`; // åˆ†éš”ç·š
            html += `<div class="w-full sm:hidden h-2"></div>`; // æ‰‹æ©Ÿç‰ˆæ›è¡Œé–“éš”
            mainSet.back.forEach((n, i) => html += renderBall(n, 'back', i + 5));
            ballsArea.innerHTML = html;

            // æ›´æ–°æ­·å²
            if(historyContainer.querySelector('.text-center')) historyContainer.innerHTML = '';

            [...newSets].reverse().forEach(set => {
                const row = document.createElement('div');
                row.className = 'flex justify-between items-center bg-white p-3 rounded-lg border border-gray-100 shadow-sm hover:border-red-200 transition-colors group';
                
                // è™Ÿç¢¼æ–‡å­—
                const text = `
                    <div class="font-mono text-sm sm:text-base font-bold">
                        <span class="text-red-600">${set.front.map(zeroPad).join(' ')}</span>
                        <span class="mx-2 text-gray-300">|</span>
                        <span class="text-blue-600">${set.back.map(zeroPad).join(' ')}</span>
                    </div>
                `;
                
                row.innerHTML = text;
                
                // è¤‡è£½æŒ‰éˆ• (æ‡¸åœé¡¯ç¤º)
                const copyBtn = document.createElement('button');
                copyBtn.className = 'text-gray-300 hover:text-blue-500 p-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-all';
                copyBtn.innerHTML = '<i class="far fa-copy"></i>';
                copyBtn.onclick = () => copyText(formatSetText(set));
                
                row.appendChild(copyBtn);
                historyContainer.insertBefore(row, historyContainer.firstChild);
                currentHistory.unshift(set);
            });
        }

        function formatSetText(set) {
            return `å‰å€: ${set.front.map(zeroPad).join(' ')} + å¾Œå€: ${set.back.map(zeroPad).join(' ')}`;
        }

        function copyResults() {
            if (currentHistory.length === 0) return showToast('è«‹å…ˆç”Ÿæˆè™Ÿç¢¼');
            // è¤‡è£½ç¬¬ä¸€æ¢
            copyText(formatSetText(currentHistory[0]));
        }

        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('è™Ÿç¢¼å·²è¤‡è£½ï¼');
            }).catch(() => {
                // Fallback
                const ta = document.createElement('textarea');
                ta.value = text;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                showToast('è™Ÿç¢¼å·²è¤‡è£½ï¼');
            });
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-msg').textContent = msg;
            toast.classList.remove('opacity-0', 'pointer-events-none');
            toast.classList.add('top-6');
            
            setTimeout(() => {
                toast.classList.add('opacity-0', 'pointer-events-none');
            }, 2000);
        }

        function clearHistory() {
            document.getElementById('history-container').innerHTML = '<div class="text-center text-xs text-gray-400 py-10">å°šç„¡æ•¸æ“š</div>';
            currentHistory = [];
        }

        // åˆå§‹åŒ–å„€è¡¨æ¿
        function initDashboard() {
            initWeights();

            // æ¸²æŸ“å‰å€ç†±è™Ÿ
            const frontContainer = document.getElementById('front-hot-stats');
            DATA_SOURCE.front.hot.slice(0, 5).forEach(num => {
                frontContainer.innerHTML += `
                    <div class="flex flex-col items-center bg-red-50 py-2 rounded border border-red-100">
                        <span class="text-lg font-bold text-red-600 font-mono leading-none">${zeroPad(num)}</span>
                    </div>`;
            });

            // æ¸²æŸ“å¾Œå€ç†±è™Ÿ
            const backContainer = document.getElementById('back-hot-stats');
            DATA_SOURCE.back.hot.slice(0, 3).forEach(num => {
                backContainer.innerHTML += `
                    <div class="flex flex-col items-center bg-blue-50 py-2 rounded border border-blue-100">
                        <span class="text-lg font-bold text-blue-600 font-mono leading-none">${zeroPad(num)}</span>
                    </div>`;
            });

            // æ¸²æŸ“åœ–è¡¨
            const ctx = document.getElementById('trendChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['091', '092', '093', '094', '095', '096', '097', '098', '099', '100'],
                    datasets: [{
                        label: 'ç†±åº¦è¶¨å‹¢',
                        data: [65, 59, 80, 81, 56, 55, 40, 70, 85, 90],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { display: false }, y: { display: false } }
                }
            });
        }

        // æ™‚é˜
        setInterval(() => {
            document.getElementById('clock').textContent = new Date().toLocaleTimeString('zh-TW', {hour12: false});
        }, 1000);

        // å•Ÿå‹•
        initDashboard();

    </script>
</body>
</html>
